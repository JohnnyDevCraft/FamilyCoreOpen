@page "/"

<PageTitle>Home</PageTitle>
@rendermode InteractiveAuto

@using System.Collections.Generic
@using System
@using Microsoft.AspNetCore.Components.Forms
@using FamilyCore.Client.Components.Widget.Forms

<div>
  <!-- Controls -->
  <div class="flex items-center justify-between mb-6">
    <h2 class="text-2xl font-semibold" style="font-family: var(--font-heading);">Theme Playground</h2>
    <div class="flex items-center space-x-3">
      <button class="px-3 py-1 rounded bg-[color:var(--color-accent-1-500)] text-white text-sm hover:bg-[color:var(--color-accent-1-600)]" @onclick="ToggleLogin">
        @if (IsLoggedIn) { <span>Switch to Public</span> } else { <span>Switch to App</span> }
      </button>
      <span class="text-sm text-[color:var(--color-text-muted-dark)]">Logged in: <strong>@IsLoggedIn</strong></span>
    </div>
  </div>

  <!-- Navbars -->
  <NavbarPublic />
  <NavbarApp UserName="@UserName"
             UserEmail="@UserEmail"
             UserAvatarUrl="@UserAvatarUrl"
             NotificationCount="3"
             OnLogout="Logout"
             OnProfile="OpenProfile"
             OnSwitchFamily="SwitchFamily" />

<!-- Panels demo: show different background token panels -->
<div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
  <div class="p-4 rounded-md shadow-sm" style="background-color: var(--color-bg-primary);">
    <h3 class="font-medium mb-2" style="font-family: var(--font-heading);">Primary Panel</h3>
    <p class="text-sm text-[color:var(--color-text-muted-dark)]">Uses --color-bg-primary</p>
  </div>

  <div class="p-4 rounded-md shadow-sm" style="background-color: var(--color-bg-secondary);">
    <h3 class="font-medium mb-2" style="font-family: var(--font-heading);">Secondary Panel</h3>
    <p class="text-sm text-[color:var(--color-text-muted-dark)]">Uses --color-bg-secondary</p>
  </div>

  <div class="p-4 rounded-md shadow-sm" style="background-color: var(--color-bg-tertiary);">
    <h3 class="font-medium mb-2" style="font-family: var(--font-heading);">Tertiary Panel</h3>
    <p class="text-sm text-[color:var(--color-text-muted-dark)]">Uses --color-bg-tertiary</p>
  </div>

  <div class="p-4 rounded-md shadow-sm" style="background-color: var(--color-bg-accent-1);">
    <h3 class="font-medium mb-2" style="font-family: var(--font-heading);">Accent 1 Panel</h3>
    <p class="text-sm text-[color:var(--color-text-muted-dark)]">Uses --color-bg-accent-1</p>
  </div>

  <div class="p-4 rounded-md shadow-sm" style="background-color: var(--color-bg-accent-2);">
    <h3 class="font-medium mb-2" style="font-family: var(--font-heading);">Accent 2 Panel</h3>
    <p class="text-sm text-[color:var(--color-text-muted-dark)]">Uses --color-bg-accent-2</p>
  </div>
</div>

<!-- Form Panel -->
<div class="p-6 rounded-md shadow mb-6" style="background-color: white;">
  <h3 class="text-lg font-semibold mb-4" style="font-family: var(--font-heading);">Themed Form (Widgets Preview)</h3>

  <EditForm Model="@Model" OnValidSubmit="HandleValidSubmit" class="max-w-2xl">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div class="space-y-4">
      <TextEdit @bind-Value="Model.FullName" LabelText="Full name" PlaceholderText="Jane Doe" />
      <PhoneEdit @bind-Value="Model.Phone" LabelText="Phone" PlaceholderText="(999)999-9999" />
      <EmailEdit @bind-Value="Model.Email" LabelText="Email" PlaceholderText="email@example.com" />
      <UrlEdit @bind-Value="Model.Website" LabelText="Website" PlaceholderText="https://..." />

      <DropDown @bind-Value="Model.Role" LabelText="Role" Options="RoleOptions" />
      <CheckBox @bind-Value="Model.Subscribe" LabelText="Subscribe to updates" />
      <RadioSelect @bind-Value="Model.PreferredContact" LabelText="Preferred contact" Options="ContactOptions" />

      <LongTextEdit @bind-Value="Model.Notes" LabelText="Notes" PlaceholderText="Any additional notes..." />

      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <CurrencyBox @bind-Value="Model.Balance" LabelText="Balance" />
        <PercentBox @bind-Value="Model.Discount" LabelText="Discount" />
        <NumberBox @bind-Value="Model.Quantity" LabelText="Quantity" Precision="0" />
      </div>

      <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
        <DateEditor @bind-Value="Model.BirthDate" LabelText="Birth date" />
        <DateTimeEditor @bind-Value="Model.NextAppointment" LabelText="Next appointment" />
        <TimeEditor @bind-Value="Model.PreferredTime" LabelText="Preferred time" />
      </div>

      <div class="pt-2">
        <button type="submit" class="px-4 py-2 rounded bg-[color:var(--color-primary-500)] text-white hover:bg-[color:var(--color-primary-600)]">Save</button>
        <button type="button" class="ml-3 px-4 py-2 rounded border border-[color:var(--color-primary-500)] text-[color:var(--color-primary-500)] hover:bg-[color:var(--color-bg-primary-muted)]" @onclick="ResetForm">Reset</button>
      </div>
    </div>
  </EditForm>
</div>

<!-- Buttons Panel -->
<div class="p-6 rounded-md shadow mb-6 bg-white">
  <h3 class="text-lg font-semibold mb-4" style="font-family: var(--font-heading);">Button Variants</h3>
  <div class="flex flex-wrap gap-3 items-center">
    <button class="px-4 py-2 rounded bg-[color:var(--color-primary-500)] text-white hover:bg-[color:var(--color-primary-600)]">Primary</button>
    <button class="px-4 py-2 rounded border border-[color:var(--color-primary-500)] text-[color:var(--color-primary-500)] hover:bg-[color:var(--color-bg-primary-muted)]">Outline</button>
    <button class="px-4 py-2 rounded text-[color:var(--color-primary-500)] hover:bg-[color:var(--color-bg-accent-1-muted)]">Ghost</button>

    <button class="px-6 py-3 rounded bg-[color:var(--color-secondary-500)] text-white ml-4">Large</button>
    <button class="px-2 py-1 rounded bg-[color:var(--color-tertiary-500)] text-white text-sm">Small</button>

    <button class="px-4 py-2 rounded bg-[color:var(--color-primary-500)] text-white opacity-50 cursor-not-allowed" disabled>Disabled</button>
  </div>
</div>
</div>

<!-- Footers -->
@if (!IsLoggedIn)
{
  <footer class="mt-6 p-4 rounded-md" style="background-color: var(--color-bg-accent-2);">
    <div class="flex justify-between items-center">
      <div class="text-sm text-[color:var(--color-text-muted-dark)]">© FamilyCenter Public</div>
      <div class="text-sm text-[color:var(--color-text-muted-dark)]">Contact • Privacy</div>
    </div>
  </footer>
}
else
{
  <footer class="mt-6 p-4 rounded-md" style="background-color: var(--color-bg-tertiary);">
    <div class="flex justify-between items-center">
      <div class="text-sm text-[color:var(--color-text-muted-dark)]">© FamilyCenter • Dashboard</div>
      <div class="flex items-center space-x-3 text-sm">
        <a class="hover:underline">Help</a>
        <a class="hover:underline">Feedback</a>
      </div>
    </div>
  </footer>
}

@code {
    // Toggle to preview public vs in-app states; adapt later to real auth.
    bool IsLoggedIn { get; set; } = false;

    string UserName { get; set; } = "Alex Johnson";
    string UserEmail { get; set; } = "alex.johnson@example.com";
    string UserAvatarUrl { get; set; } = "/images/logo-icon.png";

    void ToggleLogin()
    {
        IsLoggedIn = !IsLoggedIn;
    }

    void Logout()
    {
        IsLoggedIn = false;
    }

    void OpenProfile()
    {
        Console.WriteLine("Profile clicked");
    }

    void SwitchFamily()
    {
        Console.WriteLine("Switch Family clicked");
    }

    // --- Form model & demo data for widgets preview ---
    FormModel Model { get; set; } = new FormModel();

    Dictionary<string, object> RoleOptions { get; set; } = new Dictionary<string, object>
    {
        { "Parent", "parent" },
        { "Volunteer", "volunteer" },
        { "Staff", "staff" }
    };

    Dictionary<string, object> ContactOptions { get; set; } = new Dictionary<string, object>
    {
        { "Email", "email" },
        { "Phone", "phone" }
    };

    void HandleValidSubmit()
    {
        // quick visual confirm — expand later
        Console.WriteLine($"Saved: {Model.FullName} / {Model.Email}");
    }

    void ResetForm()
    {
        Model = new FormModel();
    }

    class FormModel
    {
        public string FullName { get; set; }
        public string Phone { get; set; }
        public string Email { get; set; }
        public string Website { get; set; }
        public string Role { get; set; }
        public bool Subscribe { get; set; }
        public string PreferredContact { get; set; }
        public string Notes { get; set; }

        public decimal? Balance { get; set; }
        public decimal? Discount { get; set; } // stored as fraction (0.15 = 15%)
        public decimal? Quantity { get; set; }

        public DateTime? BirthDate { get; set; }
        public DateTime? NextAppointment { get; set; }
        public TimeSpan? PreferredTime { get; set; }
    }
}
