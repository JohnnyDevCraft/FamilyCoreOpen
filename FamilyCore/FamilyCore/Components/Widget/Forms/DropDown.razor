@using System
@using System.Collections.Generic
@using System.Linq.Expressions
@using System.Threading.Tasks
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Forms

<div class="mb-4">
  <label class="block text-sm mb-1 text-[color:var(--color-text-muted-dark)]">@LabelText</label>
  <InputSelect TValue="string" Value="Value" ValueChanged="OnInternalChanged" ValueExpression="ValueExpression"
               class="w-full px-3 py-2 rounded-md border border-gray-200 focus:outline-none focus:ring-2 focus:ring-[color:var(--color-primary-400)]"
               disabled="@Disabled">
    <option value="">@PlaceholderText</option>
    @if (Options != null)
    {
        foreach (var kv in Options)
        {
            var optValue = kv.Value?.ToString();
            <option value="@optValue">@kv.Key</option>
        }
    }
  </InputSelect>
</div>

@code {
    [Parameter] public string LabelText { get; set; } = "";
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public string PlaceholderText { get; set; } = "-- select --";

    [Parameter] public Dictionary<string, object> Options { get; set; }

    [Parameter] public string Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public Expression<Func<string>> ValueExpression { get; set; }

    Task OnInternalChanged(string newValue)
    {
        Value = newValue;
        return ValueChanged.InvokeAsync(newValue);
    }
}
