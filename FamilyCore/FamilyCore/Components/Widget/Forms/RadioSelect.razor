@using System.Collections.Generic
@using System.Linq.Expressions
@using System.Threading.Tasks
@using Microsoft.AspNetCore.Components
@using Microsoft.AspNetCore.Components.Forms

<div class="mb-4">
  <label class="block text-sm mb-2 text-[color:var(--color-text-muted-dark)]">@LabelText</label>
  <div class="flex flex-col gap-2">
    <InputRadioGroup TValue="string" Value="Value" ValueChanged="OnInternalChanged" ValueExpression="ValueExpression">
      @if (Options != null)
      {
          foreach (var kv in Options)
          {
              var optValue = kv.Value?.ToString();
              <label class="inline-flex items-center text-sm text-[color:var(--color-text-muted-dark)]">
                <InputRadio TValue="string"
                            Value="@optValue"
                            class="text-[color:var(--color-primary-500)] focus:ring-[color:var(--color-primary-400)] h-4 w-4"
                            disabled="@Disabled" />
                <span class="ml-2">@kv.Key</span>
              </label>
          }
      }
    </InputRadioGroup>
  </div>
</div>

@code {
    [Parameter] public string LabelText { get; set; } = "";
    [Parameter] public bool Disabled { get; set; }
    [Parameter] public Dictionary<string, object> Options { get; set; }

    [Parameter] public string Value { get; set; }
    [Parameter] public EventCallback<string> ValueChanged { get; set; }
    [Parameter] public Expression<System.Func<string>> ValueExpression { get; set; }

    Task OnInternalChanged(string newValue)
    {
        Value = newValue;
        return ValueChanged.InvokeAsync(newValue);
    }
}
